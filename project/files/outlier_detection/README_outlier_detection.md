# 外れ値検証レポート - Taninaka（谷中健介）データの統計的検証

## 📋 検証概要

**検証日**: 2025-11-02
**対象者**: Taninaka（谷中健介）
**目的**: Taninakaのデータを外れ値として除外することの統計的妥当性を検証

---

## 🔬 検証方法

3つの統計的手法を用いて外れ値を検出:

### 1. Grubbs検定（最大/最小値の外れ値検定）
- **概要**: 最も一般的な外れ値検定。データセット中の最大値または最小値が外れ値であるかを検定
- **有意水準**: α = 0.05
- **帰無仮説**: データに外れ値は存在しない
- **判定基準**: G統計量 > G臨界値 → 外れ値と判定

### 2. IQR法（四分位範囲法）
- **概要**: 四分位範囲（Q3 - Q1）を用いた外れ値検出
- **パラメータ**: k = 1.5（標準値）
- **境界値**:
  - 下限 = Q1 - 1.5 × IQR
  - 上限 = Q3 + 1.5 × IQR
- **判定基準**: データが境界値の外 → 外れ値と判定

### 3. z-score法
- **概要**: 標準化スコアに基づく外れ値検出
- **閾値**: |z| > 3.0
- **判定基準**: z-scoreの絶対値が閾値を超える → 外れ値と判定

---

## 📊 検証結果サマリー

### Performance（タスク遂行時間）

| 統計量 | 値 |
|--------|-----|
| サンプルサイズ | n = 9 |
| 平均 | 27.79秒 |
| 標準偏差 | 10.01秒 |
| 中央値 | 24.42秒 |
| Taninakaの値 | **53.09秒** |
| 平均との差 | +25.31秒 (**+2.53 SD**) |

#### 外れ値検定結果

| 検定方法 | 判定 | 詳細 |
|---------|------|------|
| **Grubbs検定** | ✗ **外れ値あり** | G統計量 = 2.53 > 臨界値 2.22 |
| **IQR法** | ✗ **外れ値** | 53.09 > 上限 31.53 |
| **z-score法** | ✓ 正常範囲 | z = 2.53 < 閾値 3.0 |

**結論**: **Performanceデータでは統計的に外れ値と判定される**

---

### Subjective（主観評価）- 全6項目の平均

| 統計量 | 値 |
|--------|-----|
| サンプルサイズ | n = 9 |
| 平均 | 3.18 |
| 標準偏差 | 0.72 |
| 中央値 | 3.43 |
| Taninakaの値 | **3.43** |
| 平均との差 | +0.26 (**+0.35 SD**) |

#### 外れ値検定結果

| 検定方法 | 判定 | 詳細 |
|---------|------|------|
| **Grubbs検定** | ✓ 外れ値なし | G統計量 = 1.41 < 臨界値 2.22 |
| **IQR法** | ✓ 正常範囲 | 3.43 ∈ [0.30, 5.63] |
| **z-score法** | ✓ 正常範囲 | z = 0.35 < 閾値 3.0 |

**結論**: **主観評価（全項目）では外れ値ではない**

---

### Subjective（主観評価）- Readabilityのみ

| 統計量 | 値 |
|--------|-----|
| サンプルサイズ | n = 9 |
| 平均 | 3.78 |
| 標準偏差 | 0.92 |
| 中央値 | 3.80 |
| Taninakaの値 | **3.80** |
| 平均との差 | +0.02 (**+0.02 SD**) |

#### 外れ値検定結果

| 検定方法 | 判定 | 詳細 |
|---------|------|------|
| **Grubbs検定** | ✓ 外れ値なし | G統計量 = 1.98 < 臨界値 2.22 |
| **IQR法** | ✓ 正常範囲 | 3.80 ∈ [2.00, 5.20] |
| **z-score法** | ✓ 正常範囲 | z = 0.02 < 閾値 3.0 |

**結論**: **Readabilityでも外れ値ではない**

---

### NASA-TLX（認知負荷）

| 統計量 | 値 |
|--------|-----|
| サンプルサイズ | n = 10 |
| 平均 | 44.98 |
| 標準偏差 | 27.09 |
| 中央値 | 62.03 |
| Taninakaの値 | **66.60** |
| 平均との差 | +21.62 (**+0.80 SD**) |

#### 外れ値検定結果

| 検定方法 | 判定 | 詳細 |
|---------|------|------|
| **Grubbs検定** | ✓ 外れ値なし | G統計量 = 1.64 < 臨界値 2.29 |
| **IQR法** | ✓ 正常範囲 | 66.60 ∈ [-47.18, 134.95] |
| **z-score法** | ✓ 正常範囲 | z = 0.80 < 閾値 3.0 |

**結論**: **NASA-TLXでは外れ値ではない**

---

## 📈 総合評価

### 外れ値判定の集計

| データセット | Grubbs | IQR | z-score | 外れ値判定率 |
|-------------|--------|-----|---------|------------|
| **Performance** | ✗ | ✗ | ✓ | **66.7%** |
| **Subjective (全項目)** | ✓ | ✓ | ✓ | 0% |
| **Subjective (Readability)** | ✓ | ✓ | ✓ | 0% |
| **NASA-TLX** | ✓ | ✓ | ✓ | 0% |

**全体**: 12回の検定中、2回で外れ値と判定（**16.7%**）

---

## 💡 結論と推奨事項

### 統計的結論

1. **Performanceデータ**では、TaninakaのデータはGrubbs検定とIQR法で**統計的に外れ値**と判定される
   - 平均から+2.53 SD離れている（53.09秒 vs 平均27.79秒）
   - 他の参加者の約2倍の遂行時間

2. **主観評価（Subjective）**と**認知負荷（NASA-TLX）**では、**外れ値ではない**
   - すべての検定で正常範囲内
   - 平均からの乖離は小さい（0.35 SD以下）

### 推奨事項

#### オプション1: データセット別の除外（推奨）

**Performance分析のみ**でTaninakaを除外し、**SubjectiveとNASA-TLX分析には含める**

✅ **メリット**:
- 統計的根拠に基づいた除外
- データの最大活用
- 各指標で独立した判断

⚠️ **デメリット**:
- 参加者数がデータセット間で異なる
- 解釈が複雑になる可能性

---

#### オプション2: 全データセットから除外（現状）

すべての分析からTaninakaを除外（Performance、Subjective、NASA-TLX）

✅ **メリット**:
- 参加者数の一貫性
- 解釈がシンプル
- Performanceでの極端な外れ値が他の指標にも影響している可能性

⚠️ **デメリット**:
- 統計的には主観評価とNASA-TLXで外れ値ではない
- サンプルサイズの不必要な減少

---

#### オプション3: Taninakaを含めて分析

すべてのデータにTaninakaを含める

✅ **メリット**:
- 最大サンプルサイズ（n = 9）
- データの完全性

⚠️ **デメリット**:
- **Performanceデータで統計的検出力が低下**
- 平均値が歪む可能性

---

### 🎯 最終推奨

**現状の「全データセットから除外（オプション2）」を維持することを推奨**

**理由**:
1. **Performanceデータで明確な外れ値**（統計的に有意）
2. **実験手順の問題の可能性**: 遂行時間が他の参加者の2倍というのは、タスクの理解や実施に問題があった可能性を示唆
3. **参加者数の一貫性**: 論文執筆時の説明がシンプル
4. **保守的なアプローチ**: 主観評価とNASA-TLXでも平均より高めの値（中央値付近だが）

---

## 📁 ファイル構成

```
outlier_detection/
├── README_outlier_detection.md          # このファイル
├── outlier_detection_results.xlsx       # 詳細な統計結果
├── performance_outlier_detection.png    # Performance可視化
├── subjective_outlier_detection.png     # Subjective全項目可視化
├── subjective_readability_outlier_detection.png  # Readability可視化
└── nasatlx_outlier_detection.png        # NASA-TLX可視化
```

---

## 🔧 再現方法

```bash
# 仮想環境を有効化
source project/.venv/bin/activate

# 外れ値検証スクリプトを実行
python project/src/analysis/outlier_detection.py
```

---

## 📚 参考文献

1. **Grubbs検定**:
   - Grubbs, F. E. (1950). Sample criteria for testing outlying observations. *The Annals of Mathematical Statistics*, 21(1), 27-58.

2. **IQR法**:
   - Tukey, J. W. (1977). *Exploratory data analysis*. Addison-Wesley.

3. **z-score法**:
   - Shiffler, R. E. (1988). Maximum Z scores and outliers. *The American Statistician*, 42(1), 79-80.

---

## 📝 更新履歴

- **2025-11-02**: 初回検証実施
  - Performanceデータで統計的外れ値を確認
  - 主観評価とNASA-TLXでは外れ値ではないことを確認
  - 全データセットからの除外を推奨

---

**最終更新**: 2025-11-02
**検証スクリプト**: `project/src/analysis/outlier_detection.py`
